sudo: required

services:
  - docker

language: go

notifications:
  email: true

go:
- 1.8

before_install:
- curl -Ls https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip > ngrok.zip
- unzip ngrok.zip
- rm ngrok.zip
- export PATH=$(pwd):$PATH
- export GO15VENDOREXPERIMENT=1
- ln -s /go/src/frusdelion/kube-lego /go/src/jetstack/kube-lego
install:
- make depend
script:
- docker login -e="${DOCKER_EMAIL}" -u="${DOCKER_USERNAME}" -p="${DOCKER_PASSWORD}"
- make build
- make image
- make push APP_VERSION=${TRAVIS_COMMIT} IMAGE_TAGS="${TRAVIS_TAG} latest"
